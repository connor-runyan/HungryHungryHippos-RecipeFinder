{% extends 'base.html' %}

{% block head %}
  {% load staticfiles %}
  <link rel="stylesheet" href="{% static 'recipe/full_recipe.css' %}" />
  <link rel="stylesheet" href="{% static 'recipe/rating.css' %}" />
{% endblock %}

{% block content %}
{% if current_recipe %}
  <div class="content">
    {% if current_recipe.user.id == user.id %}
        <a class="btn btn-dark btn-sm" href="{% url 'recipe:edit_private_recipe' current_recipe.id %}">Edit</a>
    {% endif %}
    <img src="{{current_recipe.image_url}}" />
    <h1>{{current_recipe.title}}</h1>
    <div class="text-center">
      {% if current_recipe.source_url %}
        <a class="source-url" href="{{current_recipe.source_url}}">{{ current_recipe.source_url | truncatechars:50 }}</a>
      {% endif %}
    </div>
    <div id="rating-container" class="text-center">
      <div id="rating-stars">
        <!-- Javascript creates stars -->
      </div>
      <div id="rating-count">
        <!-- Javascript creates count -->
      </div>

      {% if user.is_authenticated %}
        <div id="rating-container" class="row">
          <div class="col-sm-1"></div>
          {% for i in "12345" %}
            <div class="col-sm-2">
              <button type="button" class="btn btn-primary" value="{{ i }}">{{ i }}</button>
            </div>
          {% endfor %}
          <div class="col-sm-1"></div>
        </div>
      {% endif %}
    </div>
    <p class="text-center">Time: {{current_recipe.time}} minutes <span class="spacing"></span> Difficulty: {{current_recipe.get_difficulty_display}}</p>
    <h2>{{current_recipe.summary}}</h2>
    <hr />
    {% if ingredients %}
      <div class="ingredients-list">
        {% for ingredient in ingredients %}
          <div>
            {{ingredient.amount}} {{ingredient.unit}} {{ingredient.ingredient}}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    <hr />
    <div class="instructions">
      <p>{{current_recipe.instructions | safe}}</p>
    </div>
  </div>
{% else %}
  <p>Could not load selected recipe.</p>
{% endif %}
{% endblock %}

{% block footer %}
<script>
  const URL_RATE = "{% url 'recipe:rate' current_recipe.id %}";
  const IMG_STAR_FULL = "{% static 'recipe/images/star-full.png' %}";
  const IMG_STAR_EMPTY = "{% static 'recipe/images/star-empty.png' %}";
</script>
<script src="{% static 'recipe/rating.js' %}"></script>
{% endblock %}
